"use strict";(self.webpackChunkOmera=self.webpackChunkOmera||[]).push([[9869],{9869:(f,m,c)=>{c.r(m),c.d(m,{VendorCouponsComponent:()=>T});var d=c(177),i=c(9417),p=c(8147),u=c(8325),t=c(7019),_=c(5312),h=c(1626);let b=(()=>{class e{constructor(o){this._HttpClient=o,this.baseUrl=_.c.baseURL}couponsStatus(o){return this._HttpClient.get(`${this.baseUrl}/v1/vendor-coupon-stats/${o}/`)}listCoupons(o){return this._HttpClient.get(`${this.baseUrl}/v1/vendor-coupon-list/${o}/`)}createCoupon(o,n){return this._HttpClient.post(`${this.baseUrl}/v1/vendor-coupon-create/${o}/`,n)}deleteCoupon(o,n){return this._HttpClient.delete(`${this.baseUrl}/v1/vendor-coupon-detail/${o}/${n}/`)}couponDetails(o,n){return this._HttpClient.get(`${this.baseUrl}/v1/vendor-coupon-detail/${o}/${n}/`)}updateCoupon(o,n,s){return this._HttpClient.patch(`${this.baseUrl}/v1/vendor-coupon-detail/${o}/${n}/`,s)}static{this.\u0275fac=function(n){return new(n||e)(t.KVO(h.Qq))}}static{this.\u0275prov=t.jDH({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var g=c(3664);function v(e,l){1&e&&(t.j41(0,"td"),t.EFF(1),t.nI1(2,"translate"),t.k0s()),2&e&&(t.R7$(1),t.JRh(t.bMT(2,1,"dashboard.Active")))}function F(e,l){1&e&&(t.j41(0,"td"),t.EFF(1),t.nI1(2,"translate"),t.k0s()),2&e&&(t.R7$(1),t.JRh(t.bMT(2,1,"dashboard.Not Active")))}function R(e,l){if(1&e){const o=t.RV6();t.j41(0,"tr")(1,"td"),t.EFF(2),t.k0s(),t.j41(3,"td"),t.EFF(4),t.k0s(),t.DNE(5,v,3,3,"td",34),t.DNE(6,F,3,3,"td",34),t.j41(7,"td",35)(8,"button",36),t.bIt("click",function(){const a=t.eBV(o).$implicit;t.XpG(2);const r=t.sdS(23),x=t.sdS(56),E=t.XpG();return t.Njj(E.couponDetails(a.id,r,x))}),t.nrm(9,"i",37),t.k0s(),t.j41(10,"button",38),t.bIt("click",function(){const a=t.eBV(o).$implicit,r=t.XpG(3);return t.Njj(r.deleteCoupon(a.id))}),t.nrm(11,"i",39),t.k0s()()()}if(2&e){const o=l.$implicit;t.R7$(2),t.JRh(o.code),t.R7$(2),t.JRh(o.discount+"%"),t.R7$(1),t.Y8G("ngIf",o.active),t.R7$(1),t.Y8G("ngIf",0==o.active)}}function I(e,l){if(1&e&&(t.j41(0,"table",32)(1,"thead")(2,"tr")(3,"th"),t.EFF(4),t.nI1(5,"translate"),t.k0s(),t.j41(6,"th"),t.EFF(7),t.nI1(8,"translate"),t.k0s(),t.j41(9,"th"),t.EFF(10),t.nI1(11,"translate"),t.k0s(),t.j41(12,"th"),t.EFF(13),t.nI1(14,"translate"),t.k0s()()(),t.j41(15,"tbody"),t.DNE(16,R,12,4,"tr",33),t.k0s()()),2&e){const o=t.XpG(2);t.R7$(4),t.JRh(t.bMT(5,5,"dashboard.Code")),t.R7$(3),t.JRh(t.bMT(8,7,"dashboard.Discount")),t.R7$(3),t.JRh(t.bMT(11,9,"dashboard.Status")),t.R7$(3),t.JRh(t.bMT(14,11,"dashboard.Action")),t.R7$(3),t.Y8G("ngForOf",o.allCoupons)}}function D(e,l){if(1&e){const o=t.RV6();t.j41(0,"button",40),t.bIt("click",function(){t.eBV(o),t.XpG();const s=t.sdS(23),a=t.sdS(60),r=t.XpG();return t.Njj(r.createCoupon(s,a))}),t.EFF(1),t.nI1(2,"translate"),t.k0s()}2&e&&(t.R7$(1),t.JRh(t.bMT(2,1,"dashboard.Create Coupon")))}function k(e,l){if(1&e){const o=t.RV6();t.j41(0,"button",41),t.bIt("click",function(){t.eBV(o),t.XpG();const s=t.sdS(23),a=t.XpG();return t.Njj(a.updateCoupon(a.couponId,s))}),t.EFF(1),t.nI1(2,"translate"),t.k0s()}2&e&&(t.R7$(1),t.JRh(t.bMT(2,1,"dashboard.Update Coupon")))}const C=function(e){return{"is-invalid":e}};function j(e,l){if(1&e){const o=t.RV6();t.j41(0,"section",2)(1,"div",3)(2,"h1"),t.EFF(3),t.nI1(4,"translate"),t.k0s(),t.j41(5,"button",4),t.bIt("click",function(){t.eBV(o);const s=t.sdS(23),a=t.XpG();return t.Njj(a.editCoupon(s))}),t.EFF(6),t.nI1(7,"translate"),t.k0s(),t.j41(8,"div",5)(9,"div",6)(10,"P",7),t.EFF(11),t.nI1(12,"translate"),t.k0s(),t.j41(13,"P",8),t.EFF(14),t.k0s()(),t.j41(15,"div",6)(16,"P",7),t.EFF(17),t.nI1(18,"translate"),t.k0s(),t.j41(19,"P",8),t.EFF(20),t.k0s()()(),t.DNE(21,I,17,13,"table",9),t.j41(22,"div",10,11)(24,"div",12)(25,"div",13)(26,"h2",14),t.EFF(27),t.nI1(28,"translate"),t.k0s(),t.j41(29,"i",15),t.bIt("click",function(){t.eBV(o);const s=t.sdS(23),a=t.XpG();return t.Njj(a.closeLayer(s))}),t.k0s()(),t.nrm(30,"hr",16),t.j41(31,"form",17)(32,"div",18)(33,"label",19),t.EFF(34),t.nI1(35,"translate"),t.k0s(),t.nrm(36,"input",20),t.nI1(37,"translate"),t.j41(38,"p",21),t.EFF(39),t.nI1(40,"translate"),t.k0s()(),t.j41(41,"div",18)(42,"label",22),t.EFF(43),t.nI1(44,"translate"),t.k0s(),t.nrm(45,"input",23),t.nI1(46,"translate"),t.j41(47,"p",21),t.EFF(48),t.nI1(49,"translate"),t.k0s()(),t.j41(50,"div",24),t.nrm(51,"input",25),t.j41(52,"label",26),t.EFF(53),t.nI1(54,"translate"),t.k0s()(),t.j41(55,"div",null,27),t.DNE(57,D,3,3,"button",28),t.DNE(58,k,3,3,"button",29),t.j41(59,"p",30,31),t.EFF(61),t.nI1(62,"translate"),t.k0s()()()()()()()}if(2&e){const o=t.XpG();let n,s;t.Y8G("dir",o.isArabic()?"rtl":"ltr"),t.R7$(3),t.JRh(t.bMT(4,23,"dashboard.Coupons")),t.R7$(3),t.JRh(t.bMT(7,25,"dashboard.Create New Coupon")),t.R7$(5),t.JRh(t.bMT(12,27,"dashboard.TOTAL COUPONS")),t.R7$(3),t.JRh(o.allCouponsNum),t.R7$(3),t.JRh(t.bMT(18,29,"dashboard.ACTIVE COUPONS")),t.R7$(3),t.JRh(o.activateCoupons),t.R7$(1),t.Y8G("ngIf",o.allCoupons.length>0),t.R7$(6),t.JRh(t.bMT(28,31,"dashboard.Create New Coupon")),t.R7$(4),t.Y8G("formGroup",o.couponDataForm),t.R7$(3),t.JRh(t.bMT(35,33,"dashboard.Code")),t.R7$(2),t.Y8G("ngClass",t.eq3(49,C,(null==(n=o.couponDataForm.get("code"))?null:n.errors)&&(null==(n=o.couponDataForm.get("code"))?null:n.touched)))("placeholder",t.bMT(37,35,"dashboard.Enter Coupon Code")),t.R7$(3),t.Lme("",t.bMT(40,37,"dashboard.E.G")," ",": "," CODE2024"),t.R7$(4),t.JRh(t.bMT(44,39,"dashboard.Discount")),t.R7$(2),t.Y8G("ngClass",t.eq3(51,C,(null==(s=o.couponDataForm.get("discount"))?null:s.errors)&&(null==(s=o.couponDataForm.get("discount"))?null:s.touched)))("placeholder",t.bMT(46,41,"dashboard.Enter Discount")),t.R7$(3),t.JRh(t.bMT(49,43,"dashboard.Discount is in Percentage")),t.R7$(5),t.JRh(t.bMT(54,45,"dashboard.Active Coupon")),t.R7$(4),t.Y8G("ngIf",0==o.couponId),t.R7$(1),t.Y8G("ngIf",0!==o.couponId),t.R7$(3),t.JRh(t.bMT(62,47,"dashboard.Coupon alert"))}}function $(e,l){1&e&&(t.j41(0,"div",42),t.nrm(1,"app-loading"),t.k0s())}let T=(()=>{class e{constructor(o,n,s,a,r){this._FormBuilder=o,this._VendorCoponsService=n,this._AuthService=s,this._Renderer2=a,this.translate=r,this.allCoupons=[],this.couponId=0,this.vendorId=0,this.couponsName=[],this.loading=!0,this.couponDataForm=this._FormBuilder.group({code:["",[i.k0.required]],discount:["",[i.k0.required]],active:[!1]})}couponStatus(){this.loading=!0,this._VendorCoponsService.couponsStatus(this.vendorId).subscribe({next:o=>{console.log(o),this.allCouponsNum=o[0].total_coupons,this.activateCoupons=o[0].active_coupons,this.loading=!1},error:o=>{console.log(o)}})}createCoupon(o,n){if(this.couponDataForm.valid){for(const s of this.allCoupons)this.couponsName.push(s.code);if(this.couponsName.includes(this.couponDataForm.get("code")?.value))this._Renderer2.removeClass(n,"d-none");else{console.log(this.couponsName);const s=this._FormBuilder.group({vendor_id:1,code:this.couponDataForm.get("code")?.value,discount:this.couponDataForm.get("discount")?.value,active:this.couponDataForm.get("active")?.value}),a=new FormData;Object.keys(s.value).forEach(r=>{a.append(r,s.get(r)?.value)}),this._VendorCoponsService.createCoupon(this.vendorId,a).subscribe({next:r=>{console.log(r),this._Renderer2.addClass(o,"d-none"),"Coupon Created Successfully."==r.message&&this.getAllCoupons()},error:r=>{console.log(r)}})}}else console.log("all inputs are required"),this.couponDataForm.markAllAsTouched()}getAllCoupons(){this.loading=!0,this._VendorCoponsService.listCoupons(this.vendorId).subscribe({next:o=>{console.log(o,"allcop"),this.allCoupons=o,this.loading=!1},error:o=>{console.log(o)}})}ngOnInit(){this._AuthService.decodeToken(),this.vendorId=this._AuthService.userInfo.vendor_id,this.getAllCoupons(),this.couponStatus()}editCoupon(o){this.couponId=0,this.couponDataForm.get("code")?.setValue(""),this.couponDataForm.get("discount")?.setValue(""),this.couponDataForm.get("active")?.setValue(!1),this._Renderer2.removeClass(o,"d-none")}closeLayer(o){this._Renderer2.addClass(o,"d-none"),this.couponId=0}deleteCoupon(o){this._VendorCoponsService.deleteCoupon(this.vendorId,o).subscribe({next:n=>{console.log(n),null==n&&(this.getAllCoupons(),this.couponStatus())},error:n=>{console.log(n)}})}couponDetails(o,n,s){this.couponId=o,this._VendorCoponsService.couponDetails(this.vendorId,o).subscribe({next:a=>{console.log(a),this._Renderer2.removeClass(n,"d-none"),this.couponDataForm.get("code")?.setValue(a.code),this.couponDataForm.get("discount")?.setValue(a.discount),this.couponDataForm.get("active")?.setValue(a.active)},error:a=>{console.log(a)}})}updateCoupon(o,n){if(this.couponDataForm.valid){const s=this._FormBuilder.group({vendor_id:1,code:this.couponDataForm.get("code")?.value,discount:this.couponDataForm.get("discount")?.value,active:this.couponDataForm.get("active")?.value}),a=new FormData;Object.keys(s.value).forEach(r=>{a.append(r,s.get(r)?.value)}),this._VendorCoponsService.updateCoupon(this.vendorId,o,a).subscribe({next:r=>{console.log(r),this._Renderer2.addClass(n,"d-none"),this.getAllCoupons(),this.couponStatus()},error:r=>{console.log(r)}})}else console.log("all inputs are required"),this.couponDataForm.markAllAsTouched()}isArabic(){return"ar"===this.translate.currentLang}static{this.\u0275fac=function(n){return new(n||e)(t.rXU(i.ok),t.rXU(b),t.rXU(g.u),t.rXU(t.sFG),t.rXU(p.c$))}}static{this.\u0275cmp=t.VBU({type:e,selectors:[["app-vendor-coupons"]],standalone:!0,features:[t.aNF],decls:3,vars:2,consts:[["class","py-5",3,"dir",4,"ngIf","ngIfElse"],["notload",""],[1,"py-5",3,"dir"],[1,"container"],[1,"btn","btn-main","text-white",3,"click"],[1,"d-flex","align-items-center","justify-content-between","mt-4","gap-3"],[1,"w-50","bg-white","shadow","p-4","rounded-3"],[1,"mb-4"],[1,"h2"],["class","table align-middle mt-3",4,"ngIf"],[1,"layer","position-fixed","top-0","bottom-0","start-0","end-0","d-flex","justify-content-center","align-items-center","d-none"],["layer",""],[1,"couponData","bg-white","w-50","p-4"],[1,"d-flex","justify-content-between","align-items-center"],[1,"h5"],["role","button",1,"fa","fa-solid","fa-close","fa-x",3,"click"],[1,"my-3"],[3,"formGroup"],[1,"mb-3"],["for","code"],["type","text","id","code","formControlName","code",1,"form-control","w-100","my-1",3,"ngClass","placeholder"],[1,"small","text-secondary","ms-1"],["for","dicount"],["min","0","max","100","type","number","id","dicount","formControlName","discount",1,"form-control","w-100","my-1",3,"ngClass","placeholder"],[1,"d-flex","align-items-center","justify-content-start","gap-2"],["type","checkbox","name","active","id","active","formControlName","active",1,"active","m-0"],["for","active",1,"inline"],["formButtons",""],["class","btn btn-primary my-3 me-2",3,"click",4,"ngIf"],["class","btn btn-success my-3",3,"click",4,"ngIf"],[1,"alert","alert-danger","d-none"],["alert",""],[1,"table","align-middle","mt-3"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"d-flex","gap-2"],[1,"btn","btn-success",3,"click"],[1,"fa-solid","fa-pen-to-square"],[1,"btn","btn-danger",3,"click"],[1,"fa-solid","fa-trash"],[1,"btn","btn-primary","my-3","me-2",3,"click"],[1,"btn","btn-success","my-3",3,"click"],[1,"d-flex","justify-content-center","align-items-center","vh-100"]],template:function(n,s){if(1&n&&(t.DNE(0,j,63,53,"section",0),t.DNE(1,$,2,0,"ng-template",null,1,t.C5r)),2&n){const a=t.sdS(2);t.Y8G("ngIf",!s.loading)("ngIfElse",a)}},dependencies:[d.MD,d.YU,d.Sq,d.bT,i.X1,i.qT,i.me,i.Q0,i.Zm,i.BC,i.cb,i.VZ,i.zX,i.j4,i.JD,p.h,p.D9,u.q],styles:[".layer[_ngcontent-%COMP%]{z-index:99999;background-color:#0000007b}.active[_ngcontent-%COMP%]{width:20px!important}"]})}}return e})()},8325:(f,m,c)=>{c.d(m,{q:()=>p});var d=c(177),i=c(7019);let p=(()=>{class u{static{this.\u0275fac=function(h){return new(h||u)}}static{this.\u0275cmp=i.VBU({type:u,selectors:[["app-loading"]],standalone:!0,features:[i.aNF],decls:1,vars:0,consts:[[1,"loader"]],template:function(h,b){1&h&&i.nrm(0,"span",0)},dependencies:[d.MD],styles:[".loader[_ngcontent-%COMP%]{width:60px;height:60px;border:8px solid #000000;border-bottom-color:var(--main-color);border-radius:50%;display:inline-block;box-sizing:border-box;animation:_ngcontent-%COMP%_rotation 1s linear infinite}@keyframes _ngcontent-%COMP%_rotation{0%{transform:rotate(0)}to{transform:rotate(360deg)}}"]})}}return u})()}}]);