"use strict";(self.webpackChunkOmera=self.webpackChunkOmera||[]).push([[4741],{4741:(f,m,i)=>{i.r(m),i.d(m,{VendorCouponsComponent:()=>U});var u=i(6814),c=i(6223),p=i(4119),d=i(5156),t=i(8926),h=i(553),_=i(9862);let g=(()=>{class n{constructor(o){this._HttpClient=o,this.baseUrl=h.N.baseURL}couponsStatus(o){return this._HttpClient.get(`${this.baseUrl}/v1/vendor-coupon-stats/${o}/`)}listCoupons(o){return this._HttpClient.get(`${this.baseUrl}/v1/vendor-coupon-list/${o}/`)}createCoupon(o,e){return this._HttpClient.post(`${this.baseUrl}/v1/vendor-coupon-create/${o}/`,e)}deleteCoupon(o,e){return this._HttpClient.delete(`${this.baseUrl}/v1/vendor-coupon-detail/${o}/${e}/`)}couponDetails(o,e){return this._HttpClient.get(`${this.baseUrl}/v1/vendor-coupon-detail/${o}/${e}/`)}updateCoupon(o,e,s){return this._HttpClient.patch(`${this.baseUrl}/v1/vendor-coupon-detail/${o}/${e}/`,s)}static#t=this.\u0275fac=function(e){return new(e||n)(t.LFG(_.eN))};static#o=this.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var v=i(9483);function b(n,l){1&n&&(t.TgZ(0,"td"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"dashboard.Active")))}function x(n,l){1&n&&(t.TgZ(0,"td"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"dashboard.Not Active")))}function Z(n,l){if(1&n){const o=t.EpF();t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.YNc(5,b,3,3,"td",34),t.YNc(6,x,3,3,"td",34),t.TgZ(7,"td",35)(8,"button",36),t.NdJ("click",function(){const a=t.CHM(o).$implicit;t.oxw(2);const r=t.MAs(23),F=t.MAs(56),y=t.oxw();return t.KtG(y.couponDetails(a.id,r,F))}),t._UZ(9,"i",37),t.qZA(),t.TgZ(10,"button",38),t.NdJ("click",function(){const a=t.CHM(o).$implicit,r=t.oxw(3);return t.KtG(r.deleteCoupon(a.id))}),t._UZ(11,"i",39),t.qZA()()()}if(2&n){const o=l.$implicit;t.xp6(2),t.Oqu(o.code),t.xp6(2),t.Oqu(o.discount+"%"),t.xp6(1),t.Q6J("ngIf",o.active),t.xp6(1),t.Q6J("ngIf",0==o.active)}}function A(n,l){if(1&n&&(t.TgZ(0,"table",32)(1,"thead")(2,"tr")(3,"th"),t._uU(4),t.ALo(5,"translate"),t.qZA(),t.TgZ(6,"th"),t._uU(7),t.ALo(8,"translate"),t.qZA(),t.TgZ(9,"th"),t._uU(10),t.ALo(11,"translate"),t.qZA(),t.TgZ(12,"th"),t._uU(13),t.ALo(14,"translate"),t.qZA()()(),t.TgZ(15,"tbody"),t.YNc(16,Z,12,4,"tr",33),t.qZA()()),2&n){const o=t.oxw(2);t.xp6(4),t.Oqu(t.lcZ(5,5,"dashboard.Code")),t.xp6(3),t.Oqu(t.lcZ(8,7,"dashboard.Discount")),t.xp6(3),t.Oqu(t.lcZ(11,9,"dashboard.Status")),t.xp6(3),t.Oqu(t.lcZ(14,11,"dashboard.Action")),t.xp6(3),t.Q6J("ngForOf",o.allCoupons)}}function T(n,l){if(1&n){const o=t.EpF();t.TgZ(0,"button",40),t.NdJ("click",function(){t.CHM(o),t.oxw();const s=t.MAs(23),a=t.MAs(60),r=t.oxw();return t.KtG(r.createCoupon(s,a))}),t._uU(1),t.ALo(2,"translate"),t.qZA()}2&n&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"dashboard.Create Coupon")))}function q(n,l){if(1&n){const o=t.EpF();t.TgZ(0,"button",41),t.NdJ("click",function(){t.CHM(o),t.oxw();const s=t.MAs(23),a=t.oxw();return t.KtG(a.updateCoupon(a.couponId,s))}),t._uU(1),t.ALo(2,"translate"),t.qZA()}2&n&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"dashboard.Update Coupon")))}const C=function(n){return{"is-invalid":n}};function O(n,l){if(1&n){const o=t.EpF();t.TgZ(0,"section",2)(1,"div",3)(2,"h1"),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"button",4),t.NdJ("click",function(){t.CHM(o);const s=t.MAs(23),a=t.oxw();return t.KtG(a.editCoupon(s))}),t._uU(6),t.ALo(7,"translate"),t.qZA(),t.TgZ(8,"div",5)(9,"div",6)(10,"P",7),t._uU(11),t.ALo(12,"translate"),t.qZA(),t.TgZ(13,"P",8),t._uU(14),t.qZA()(),t.TgZ(15,"div",6)(16,"P",7),t._uU(17),t.ALo(18,"translate"),t.qZA(),t.TgZ(19,"P",8),t._uU(20),t.qZA()()(),t.YNc(21,A,17,13,"table",9),t.TgZ(22,"div",10,11)(24,"div",12)(25,"div",13)(26,"h2",14),t._uU(27),t.ALo(28,"translate"),t.qZA(),t.TgZ(29,"i",15),t.NdJ("click",function(){t.CHM(o);const s=t.MAs(23),a=t.oxw();return t.KtG(a.closeLayer(s))}),t.qZA()(),t._UZ(30,"hr",16),t.TgZ(31,"form",17)(32,"div",18)(33,"label",19),t._uU(34),t.ALo(35,"translate"),t.qZA(),t._UZ(36,"input",20),t.ALo(37,"translate"),t.TgZ(38,"p",21),t._uU(39),t.ALo(40,"translate"),t.qZA()(),t.TgZ(41,"div",18)(42,"label",22),t._uU(43),t.ALo(44,"translate"),t.qZA(),t._UZ(45,"input",23),t.ALo(46,"translate"),t.TgZ(47,"p",21),t._uU(48),t.ALo(49,"translate"),t.qZA()(),t.TgZ(50,"div",24),t._UZ(51,"input",25),t.TgZ(52,"label",26),t._uU(53),t.ALo(54,"translate"),t.qZA()(),t.TgZ(55,"div",null,27),t.YNc(57,T,3,3,"button",28),t.YNc(58,q,3,3,"button",29),t.TgZ(59,"p",30,31),t._uU(61),t.ALo(62,"translate"),t.qZA()()()()()()()}if(2&n){const o=t.oxw();let e,s;t.Q6J("dir",o.isArabic()?"rtl":"ltr"),t.xp6(3),t.Oqu(t.lcZ(4,23,"dashboard.Coupons")),t.xp6(3),t.Oqu(t.lcZ(7,25,"dashboard.Create New Coupon")),t.xp6(5),t.Oqu(t.lcZ(12,27,"dashboard.TOTAL COUPONS")),t.xp6(3),t.Oqu(o.allCouponsNum),t.xp6(3),t.Oqu(t.lcZ(18,29,"dashboard.ACTIVE COUPONS")),t.xp6(3),t.Oqu(o.activateCoupons),t.xp6(1),t.Q6J("ngIf",o.allCoupons.length>0),t.xp6(6),t.Oqu(t.lcZ(28,31,"dashboard.Create New Coupon")),t.xp6(4),t.Q6J("formGroup",o.couponDataForm),t.xp6(3),t.Oqu(t.lcZ(35,33,"dashboard.Code")),t.xp6(2),t.Q6J("ngClass",t.VKq(49,C,(null==(e=o.couponDataForm.get("code"))?null:e.errors)&&(null==(e=o.couponDataForm.get("code"))?null:e.touched)))("placeholder",t.lcZ(37,35,"dashboard.Enter Coupon Code")),t.xp6(3),t.AsE("",t.lcZ(40,37,"dashboard.E.G")," ",": "," CODE2024"),t.xp6(4),t.Oqu(t.lcZ(44,39,"dashboard.Discount")),t.xp6(2),t.Q6J("ngClass",t.VKq(51,C,(null==(s=o.couponDataForm.get("discount"))?null:s.errors)&&(null==(s=o.couponDataForm.get("discount"))?null:s.touched)))("placeholder",t.lcZ(46,41,"dashboard.Enter Discount")),t.xp6(3),t.Oqu(t.lcZ(49,43,"dashboard.Discount is in Percentage")),t.xp6(5),t.Oqu(t.lcZ(54,45,"dashboard.Active Coupon")),t.xp6(4),t.Q6J("ngIf",0==o.couponId),t.xp6(1),t.Q6J("ngIf",0!==o.couponId),t.xp6(3),t.Oqu(t.lcZ(62,47,"dashboard.Coupon alert"))}}function D(n,l){1&n&&(t.TgZ(0,"div",42),t._UZ(1,"app-loading"),t.qZA())}let U=(()=>{class n{constructor(o,e,s,a,r){this._FormBuilder=o,this._VendorCoponsService=e,this._AuthService=s,this._Renderer2=a,this.translate=r,this.allCoupons=[],this.couponId=0,this.vendorId=0,this.couponsName=[],this.loading=!0,this.couponDataForm=this._FormBuilder.group({code:["",[c.kI.required]],discount:["",[c.kI.required]],active:[!1]})}couponStatus(){this.loading=!0,this._VendorCoponsService.couponsStatus(this.vendorId).subscribe({next:o=>{console.log(o),this.allCouponsNum=o[0].total_coupons,this.activateCoupons=o[0].active_coupons,this.loading=!1},error:o=>{console.log(o)}})}createCoupon(o,e){if(this.couponDataForm.valid){for(const s of this.allCoupons)this.couponsName.push(s.code);if(this.couponsName.includes(this.couponDataForm.get("code")?.value))this._Renderer2.removeClass(e,"d-none");else{console.log(this.couponsName);const s=this._FormBuilder.group({vendor_id:1,code:this.couponDataForm.get("code")?.value,discount:this.couponDataForm.get("discount")?.value,active:this.couponDataForm.get("active")?.value}),a=new FormData;Object.keys(s.value).forEach(r=>{a.append(r,s.get(r)?.value)}),this._VendorCoponsService.createCoupon(this.vendorId,a).subscribe({next:r=>{console.log(r),this._Renderer2.addClass(o,"d-none"),"Coupon Created Successfully."==r.message&&this.getAllCoupons()},error:r=>{console.log(r)}})}}else console.log("all inputs are required"),this.couponDataForm.markAllAsTouched()}getAllCoupons(){this.loading=!0,this._VendorCoponsService.listCoupons(this.vendorId).subscribe({next:o=>{console.log(o,"allcop"),this.allCoupons=o,this.loading=!1},error:o=>{console.log(o)}})}ngOnInit(){this._AuthService.decodeToken(),this.vendorId=this._AuthService.userInfo.vendor_id,this.getAllCoupons(),this.couponStatus()}editCoupon(o){this.couponId=0,this.couponDataForm.get("code")?.setValue(""),this.couponDataForm.get("discount")?.setValue(""),this.couponDataForm.get("active")?.setValue(!1),this._Renderer2.removeClass(o,"d-none")}closeLayer(o){this._Renderer2.addClass(o,"d-none"),this.couponId=0}deleteCoupon(o){this._VendorCoponsService.deleteCoupon(this.vendorId,o).subscribe({next:e=>{console.log(e),null==e&&(this.getAllCoupons(),this.couponStatus())},error:e=>{console.log(e)}})}couponDetails(o,e,s){this.couponId=o,this._VendorCoponsService.couponDetails(this.vendorId,o).subscribe({next:a=>{console.log(a),this._Renderer2.removeClass(e,"d-none"),this.couponDataForm.get("code")?.setValue(a.code),this.couponDataForm.get("discount")?.setValue(a.discount),this.couponDataForm.get("active")?.setValue(a.active)},error:a=>{console.log(a)}})}updateCoupon(o,e){if(this.couponDataForm.valid){const s=this._FormBuilder.group({vendor_id:1,code:this.couponDataForm.get("code")?.value,discount:this.couponDataForm.get("discount")?.value,active:this.couponDataForm.get("active")?.value}),a=new FormData;Object.keys(s.value).forEach(r=>{a.append(r,s.get(r)?.value)}),this._VendorCoponsService.updateCoupon(this.vendorId,o,a).subscribe({next:r=>{console.log(r),this._Renderer2.addClass(e,"d-none"),this.getAllCoupons(),this.couponStatus()},error:r=>{console.log(r)}})}else console.log("all inputs are required"),this.couponDataForm.markAllAsTouched()}isArabic(){return"ar"===this.translate.currentLang}static#t=this.\u0275fac=function(e){return new(e||n)(t.Y36(c.qu),t.Y36(g),t.Y36(v.e),t.Y36(t.Qsj),t.Y36(p.sK))};static#o=this.\u0275cmp=t.Xpm({type:n,selectors:[["app-vendor-coupons"]],standalone:!0,features:[t.jDz],decls:3,vars:2,consts:[["class","py-5",3,"dir",4,"ngIf","ngIfElse"],["notload",""],[1,"py-5",3,"dir"],[1,"container"],[1,"btn","btn-main","text-white",3,"click"],[1,"d-flex","align-items-center","justify-content-between","mt-4","gap-3"],[1,"w-50","bg-white","shadow","p-4","rounded-3"],[1,"mb-4"],[1,"h2"],["class","table align-middle mt-3",4,"ngIf"],[1,"layer","position-fixed","top-0","bottom-0","start-0","end-0","d-flex","justify-content-center","align-items-center","d-none"],["layer",""],[1,"couponData","bg-white","w-50","p-4"],[1,"d-flex","justify-content-between","align-items-center"],[1,"h5"],["role","button",1,"fa","fa-solid","fa-close","fa-x",3,"click"],[1,"my-3"],[3,"formGroup"],[1,"mb-3"],["for","code"],["type","text","id","code","formControlName","code",1,"form-control","w-100","my-1",3,"ngClass","placeholder"],[1,"small","text-secondary","ms-1"],["for","dicount"],["min","0","max","100","type","number","id","dicount","formControlName","discount",1,"form-control","w-100","my-1",3,"ngClass","placeholder"],[1,"d-flex","align-items-center","justify-content-start","gap-2"],["type","checkbox","name","active","id","active","formControlName","active",1,"active","m-0"],["for","active",1,"inline"],["formButtons",""],["class","btn btn-primary my-3 me-2",3,"click",4,"ngIf"],["class","btn btn-success my-3",3,"click",4,"ngIf"],[1,"alert","alert-danger","d-none"],["alert",""],[1,"table","align-middle","mt-3"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"d-flex","gap-2"],[1,"btn","btn-success",3,"click"],[1,"fa-solid","fa-pen-to-square"],[1,"btn","btn-danger",3,"click"],[1,"fa-solid","fa-trash"],[1,"btn","btn-primary","my-3","me-2",3,"click"],[1,"btn","btn-success","my-3",3,"click"],[1,"d-flex","justify-content-center","align-items-center","vh-100"]],template:function(e,s){if(1&e&&(t.YNc(0,O,63,53,"section",0),t.YNc(1,D,2,0,"ng-template",null,1,t.W1O)),2&e){const a=t.MAs(2);t.Q6J("ngIf",!s.loading)("ngIfElse",a)}},dependencies:[u.ez,u.mk,u.sg,u.O5,c.UX,c._Y,c.Fj,c.wV,c.Wl,c.JJ,c.JL,c.qQ,c.Fd,c.sg,c.u,p.aw,p.X$,d.N],styles:[".layer[_ngcontent-%COMP%]{z-index:99999;background-color:#0000007b}.active[_ngcontent-%COMP%]{width:20px!important}"]})}return n})()},5156:(f,m,i)=>{i.d(m,{N:()=>p});var u=i(6814),c=i(8926);let p=(()=>{class d{static#t=this.\u0275fac=function(_){return new(_||d)};static#o=this.\u0275cmp=c.Xpm({type:d,selectors:[["app-loading"]],standalone:!0,features:[c.jDz],decls:1,vars:0,consts:[[1,"loader"]],template:function(_,g){1&_&&c._UZ(0,"span",0)},dependencies:[u.ez],styles:[".loader[_ngcontent-%COMP%]{width:60px;height:60px;border:8px solid #000000;border-bottom-color:var(--main-color);border-radius:50%;display:inline-block;box-sizing:border-box;animation:_ngcontent-%COMP%_rotation 1s linear infinite}@keyframes _ngcontent-%COMP%_rotation{0%{transform:rotate(0)}to{transform:rotate(360deg)}}"]})}return d})()}}]);